# Привилегированный гость

Описание: Видные люди в гостях не засиживаются
Изначально таск встречает нас эмулятором терминала

![Эмулятор терминала](./privileged-guest/1.png)

В терминале были изучены доступные команды с помощью help

![Вывод команды help](./privileged-guest/2.png)

Среди доступных команд были найдены интересующие нас команды: whoami и getFlag. Далее, был проверен вывод обеих команд

![Вывод команд whoami и getFlag](./privileged-guest/3.png)

После использования команд были изучены запросы в Burp Suite. В них замечено, что для хранения данных о пользователе используются куки

![Запрос в Burp Suite](./privileged-guest/4.png)

Далее, с помощью расширения Wappalyzer были просмотрены технологии, которые предположительно использует сайт

![Данные о технологиях в Wappalyzer](./privileged-guest/5.png)

В Wappalyzer видно, что сайт, предположительно, использует Flask на бекенде. С помощью данных с сайта [HackTricks](https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/flask) были изучены способы декодирования и подделки куки-файлов. Сначала куки-файл был декодирован на [предложенном сайте](https://www.kirsle.net/wizards/flask-session.cgi)

![Декодированный куки-файл](./privileged-guest/6.png)

После декодирования куки стало ясно, как именно происходит проверка пользователя - предположительно, сервер проверяет поле `_user_id`. Далее, с помощью утилиты [flask-unsign](https://pypi.org/project/flask-unsign/) и словаря rockyou был подобран пароль, используемый для кодирования куки

![Подбор пароля кодирования куки](./privileged-guest/7.png)

Далее, с помощью этой же утилиты был закодирован новый куки-файл, где вместо старого `_user_id` установлен `admin`

![Кодирование нового куки-файла](./privileged-guest/8.png)

После этого, с помощью инструменты Repeater в Burp Suite был получен флаг

![Получение флага](./privileged-guest/9.png)
